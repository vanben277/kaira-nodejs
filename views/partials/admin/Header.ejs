<!-- Navbar Start -->
<nav class="navbar navbar-expand bg-light navbar-light sticky-top px-4 py-0">
  <a href="/admin/" class="navbar-brand d-flex d-lg-none me-4">
    <h2 class="text-primary mb-0"><i class="fa fa-hashtag"></i></h2>
  </a>
  <a href="#" class="sidebar-toggler flex-shrink-0">
    <i class="fa fa-bars"></i>
  </a>
  <form class="d-none d-md-flex ms-4">
    <input
      class="form-control border-0"
      type="search"
      placeholder="Tìm kiếm nhanh..."
    />
  </form>
  <div class="navbar-nav align-items-center ms-auto">
    <div class="nav-item dropdown">
      <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown">
        <img
          class="rounded-circle me-lg-2"
          src="<%= session.avatar ? session.avatar : '/images/nuben.jpg' %>"
          alt=""
          style="width: 40px; height: 40px"
        />
        <span class="d-none d-lg-inline-flex">
          <% if (session.fullName) { %> <%= session.fullName %> <% } else if
          (session.email) { %> <%= session.email.split('@')[0] %> <% } else { %>
          User <% } %>
        </span>
      </a>
      <div
        class="dropdown-menu dropdown-menu-end bg-light border-0 rounded-0 rounded-bottom m-0"
      >
        <a href="#" class="dropdown-item">My Profile</a>
        <a href="#" class="dropdown-item">Settings</a>
        <a href="#" id="adminLogoutBtn" class="dropdown-item">Đăng xuất</a>
      </div>
    </div>
  </div>
</nav>
<!-- Navbar End -->

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const adminLogoutBtn = document.getElementById("adminLogoutBtn");

    if (adminLogoutBtn) {
      adminLogoutBtn.addEventListener("click", async (e) => {
        e.preventDefault();

        try {
          const response = await fetch("/auth/logout", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
          });
          const data = await response.json();
          if (data.success) {
            window.location.href = data.redirect || "/auth/signin";
          } else {
            alert(data.message);
          }
        } catch (error) {
          console.error("Lỗi khi đăng xuất:", error);
          alert("Đã xảy ra lỗi khi đăng xuất.");
        }
      });
    }
  });
</script>
